rowSums(ps_batch3_relab_negative[4,])
rowSums(ps_batch3_relab_blank[4,])
rowSums(ps_batch2_relab[4,])
rowSums(ps_batch3_relab[4,])
rowSums(ps_batch3_relab_allcells[4,])
54/339
.2/368
0.07/67
.02+.06+.04+.07
.19/368
54.33/339
rowSums(ps_batch2_relab_allcells[2,]) # 9.60
rowSums(ps_batch2_relab_positive[2,]) # 18.58
rowSums(ps_batch2_relab_negative[2,]) #4.79
rowSums(ps_batch2_relab_blank[2,]) # 21.33
rowSums(ps_batch2_relab[2,]) # 54.33 in 339 samples
#0.1602655 avg in Batch 2 so 16.03 % of Batch 2 samples
34.46/339
rowSums(ps_batch3_relab_allcells[2,]) # 0.02
rowSums(ps_batch3_relab_positive[2,]) # 0.06
rowSums(ps_batch3_relab_negative[2,]) # 0.04
rowSums(ps_batch3_relab_blank[2,]) # 0.07
rowSums(ps_batch3_relab[2,])
157.79/368
rowSums(ps_batch2_relab_allcells[1,]) # 9.60
rowSums(ps_batch2_relab_positive[1,]) # 18.58
rowSums(ps_batch2_relab_negative[1,]) #4.79
rowSums(ps_batch2_relab_blank[1,]) # 21.33
rowSums(ps_batch2_relab[1,]) # 54.33 in 339 samples
rowSums(ps_batch3_relab_allcells[1,]) # 0.02
rowSums(ps_batch3_relab_positive[1,]) # 0.06
rowSums(ps_batch3_relab_negative[1,]) # 0.04
rowSums(ps_batch3_relab_blank[1,]) # 0.07
rowSums(ps_batch3_relab[1,]) # in 368 samples
rowSums(ps_batch2_relab_allcells[1,])/ncol(ps_batch3_relab_blank) # 15.25
rowSums(ps_batch2_relab_allcells[1,])/ncol(ps_batch2_relab_allcells) # 15.25
rowSums(ps_batch2_relab_allcells[1,])/ncol(ps_batch2_relab_allcells) # 15.25
rowSums(ps_batch2_relab_positive[1,])/ncol(ps_batch2_relab_positive) # 27.06
rowSums(ps_batch2_relab_negative[1,])/ncol(ps_batch2_relab_negative) # 20.06
rowSums(ps_batch2_relab_blank[1,])/ncol(ps_batch2_relab_blank) # 21.33
rowSums(ps_batch2_relab[1,])/ncol(ps_batch2_relab)
rowSums(ps_batch3_relab_allcells[1,])/ncol(ps_batch3_relab_allcells) # 28.85
rowSums(ps_batch3_relab_positive[1,])/ncol(ps_batch3_relab_positive) # 29.99
rowSums(ps_batch3_relab_negative[1,])/ncol(ps_batch3_relab_negative) # 29.05
rowSums(ps_batch3_relab_blank[1,])/ncol(ps_batch3_relab_blank) # 21.35
rowSums(ps_batch3_relab[1,])/ncol(ps_batch3_relab)
averagevalues_batch2_allcells <- (ps_batch3_relab_allcells[,])/ncol(ps_batch3_relab_allcells)
View(averagevalues_batch2_allcells)
View(b3b_relab_0.5per)
b3b_relab_0.5per <- ps_batch3_relab_blank[(rowSums(ps_batch3_relab_blank)/ncol(ps_batch3_relab_blank)) >= 0.005,]
View(b3b_relab_0.5per)
averagevalues_batch2_allcells <- rowSums(ps_batch3_relab_allcells[,])/ncol(ps_batch3_relab_allcells)
averagevalues_batch2_positive <- rowSums(ps_batch3_relab_positive[,])/ncol(ps_batch3_relab_positive)
averagevalues_batch2_positive$batch2_pos <- rowSums(ps_batch3_relab_positive[,])/ncol(ps_batch3_relab_positive)
averagevalues_batch2_positive$batch2_pos <- as.data.frame(rowSums(ps_batch3_relab_positive[,])/ncol(ps_batch3_relab_positive))
View(averagevalues_batch2_positive)
averagevalues_batch2_positive$ <- as.data.frame(rowSums(ps_batch3_relab_positive[,])/ncol(ps_batch3_relab_positive))
averagevalues_batch2_positive <- as.data.frame(rowSums(ps_batch3_relab_positive[,])/ncol(ps_batch3_relab_positive))
View(averagevalues_batch2_positive)
averagevalues_batch2_positive <- as.data.frame((rowSums(ps_batch3_relab_positive[,])
/ncol(ps_batch3_relab_positive))*100)
rowSums(ps_batch3_relab_positive[2,])/ncol(ps_batch3_relab_positive) # 0.32
averagevalues_batch2_allcells <- as.data.frame((rowSums(ps_batch2_relab_allcells[,])
/ncol(ps_batch2_relab_allcells))*100)
averagevalues_batch2_positive <- as.data.frame((rowSums(ps_batch2_relab_positive[,])
/ncol(ps_batch2_relab_positive))*100)
averagevalues_batch2_negative <- as.data.frame((rowSums(ps_batch2_relab_negative[,])
/ncol(ps_batch2_relab_negative))*100)
averagevalues_batch2_blank <- as.data.frame((rowSums(ps_batch2_relab_blank[,])
/ncol(ps_batch2_relab_blank))*100)
averagevalues_batch3_allcells <- as.data.frame((rowSums(ps_batch3_relab_allcells[,])
/ncol(ps_batch3_relab_allcells))*100)
averagevalues_batch3_positive <- as.data.frame((rowSums(ps_batch3_relab_positive[,])
/ncol(ps_batch3_relab_positive))*100)
averagevalues_batch3_negative <- as.data.frame((rowSums(ps_batch3_relab_negative[,])
/ncol(ps_batch3_relab_negative))*100)
averagevalues_batch3_blank <- as.data.frame((rowSums(ps_batch3_relab_blank[,])
/ncol(ps_batch3_relab_blank))*100)
averageValues_batch2_bycategory <- cbind(averagevalues_batch2_allcells, averagevalues_batch2_positive,
averagevalues_batch2_negative, averagevalues_batch2_blank)
View(averageValues_batch2_bycategory)
colnames(averageValues_batch2_bycategory) <- c("Batch2 All Cells", "Batch2 Positive",
"Batch2 Negative", "Batch2 Blank")
averageValues_batch3_bycategory <- cbind(averagevalues_batch3_allcells, averagevalues_batch3_positive,
averagevalues_batch3_negative, averagevalues_batch3_blank)
colnames(averageValues_batch3_bycategory) <- c("Batch3 All Cells", "Batch3 Positive",
"Batch3 Negative", "Batch3 Blank")
View(averageValues_batch3_bycategory)
View(averageValues_batch2_bycategory)
all_averages <- cbind(averageValues_batch2_bycategory, averageValues_batch3_bycategory)
averageValues_batch2_short <- averageValues_batch2_bycategory[1:40,]
averageValues_batch3_short <- averageValues_batch3_bycategory[1:40,]
all_averages <- cbind(averageValues_batch2_short, averageValues_batch3_short)
View(all_averages)
all_averages_samples <- c(colnames(all_averages))
View(all_averages_samples)
all_averages_samples <- colnames(all_averages)
all_averages_samples <- as.data.frame(colnames(all_averages))
all_averages_samples <- as.data.frame(colnames(all_averages), 1:40)
all_averages_samples <- as.data.frame(colnames(all_averages), 1:8)
View(all_averages_samples)
all_averages_samples <- as.data.frame(colnames(all_averages))
View(all_averages_samples)
rownames(all_averages_samples) <- all_averages_samples$`colnames(all_averages)`
View(all_averages_samples)
batch <- c(2,2,2,2,3,3,3,3)
all_averages_samples <- as.data.frame(colnames(all_averages), batch)
rownames(all_averages_samples) <- all_averages_samples$`colnames(all_averages)`
all_averages_samples <- data.frame(colnames(all_averages), batch)
View(all_averages_samples)
type <- c("All Cells", "Positive", "Negative", "Blank","All Cells", "Positive", "Negative", "Blank")
seq_run <- c("JYWTK","JYWTK","JYWTK","JYWTK","JYVC7","JYVC7","JYVC7","JYVC7")
all_averages_samples <- data.frame(colnames(all_averages), batch, type, seq_run)
rownames(all_averages_samples) <- all_averages_samples$`colnames(all_averages)`
View(all_averages_samples)
all_averages_samples <- data.frame(colnames(all_averages), batch, type, seq_run)
colnames(all_averages_samples) <- c("name", "batch", "type", "seq_run")
rownames(all_averages_samples) <- all_averages_samples$name
ps_averages <- phyloseq(otu_table(all_averages), sample_data(all_averages_samples))
ps_averages <- phyloseq(otu_table(all_averages, taxa_are_rows = T), sample_data(all_averages_samples))
ordaverage <- ordinate(ps_averages, method = "PCoA", distance = "bray")
basecolor = brewer.pal(8, "Set1")
fourcolors <- colorRampPalette(basecolor)(4)
ordaverage_plot <- plot_ordination(ps_averages, ordaverage,
color = "type", shape = "seq_run")
ordaverage_plot <- ordaverage_plot + theme_bw() +
theme(text = element_text(size = 16)) +
geom_point(size = 4) +
scale_color_manual(values = tencolors)
ordaverage_plot <- ordaverage_plot + theme_bw() +
theme(text = element_text(size = 16)) +
geom_point(size = 4) +
scale_color_manual(values = fourcolors)
ordaverage_plot
fourcolors <- c("blue","green","red","purple")
ordaverage_plot <- plot_ordination(ps_averages, ordaverage,
color = "type", shape = "seq_run")
ordaverage_plot <- ordaverage_plot + theme_bw() +
theme(text = element_text(size = 16)) +
geom_point(size = 4) +
scale_color_manual(values = fourcolors)
ordaverage_plot
library(phyloseq)
library(RColorBrewer)
library(vegan)
library(ggplot2)
setwd("C:/Users/reic006/OneDrive - PNNL/Documents/R_scripts")
count_table <- read.csv(file = "test_plots/artificial.count.table.csv", header = T, row.names = 1)
relabundance_table  <- decostand(count_table, method = "total", MARGIN = 2)
Sample_names <- c("Sample01", "Sample02", "Sample03", "Sample04", "Sample05", "Sample06", "Sample07", "Sample08", "Sample09", "Sample10")
Random_category <- c("One", "One", "One", "One", "One", "Two", "Two", "Two", "Two", "Two")
Other_category <- c("Yes", "No", "Yes", "No", "Yes", "No", "Yes", "No", "Yes", "No")
metadata <- as.data.frame(cbind(Sample_names, Random_category, Other_category))
row.names(metadata) <- metadata$Sample_names
ps <- phyloseq(otu_table(relabundance_table, taxa_are_rows = T), sample_data(metadata))
ordination_bray <- ordinate(ps, method = "PCoA", distance = "bray")
ordination_bray_plot <- plot_ordination(ps, ordination_bray) +
theme_bw() +
theme(text = element_text(size = 16),
axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black")) +
geom_point(size = 4)
ordination_bray_plot
ordination_bray_plot <- plot_ordination(ps, ordination_bray,
color = "Random_category",
shape = "Other_category",
title = "PCoA of Bray-Curtis Distances for Samples") +
theme_bw() +
theme(text = element_text(size = 16),
axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black"),
plot.title = element_text(face = "bold")) +
geom_point(size = 4)
ordination_bray_plot
specificcolors <- c("Black", "Blue")
ps.random.category.one <- subset_samples(ps, Random_category == "One")
ordination_bray_cat_one <- ordinate(ps.random.category.one, method = "PCoA", distance = "bray")
ordination_bray_cat_one_plot <- plot_ordination(ps.random.category.one, ordination_bray_cat_one,
color = "Other_category") +
theme_bw() +
theme(text = element_text(size = 16),
axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black")) +
geom_point(size = 4) +
scale_color_manual(values = specificcolors)
ordination_bray_cat_one_plot
ordination_bray_nmds <- ordinate(ps, method = "NMDS", distance = "bray")
ordination_bray_nmds_plot <- plot_ordination(ps, ordination_bray_nmds,
color = "Random_category",
shape = "Other_category",
title = "NMDS of Bray-Curtis Distances for Samples") +
theme_bw() +
theme(text = element_text(size = 16),
axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black"),
plot.title = element_text(face = "bold")) +
geom_point(size = 4)
ordination_bray_nmds_plot
ordination_bray_cca <- ordinate(ps, method = "CCA", distance = "bray")
ordination_bray_cca_plot <- plot_ordination(ps, ordination_bray_cca,
color = "Random_category",
shape = "Other_category",
title = "CCA of Bray-Curtis Distances for Samples") +
theme_bw() +
theme(text = element_text(size = 16),
axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black"),
plot.title = element_text(face = "bold")) +
geom_point(size = 4)
ordination_bray_cca_plot
data(varespec)
data(varechem)
ord <- rda(varespec)
set.seed(1)
(fit <- envfit(ord, varechem, perm = 999))
status <- factor(rep(c("Class1", "Class2"), times = nrow(varespec)/2))
head(status)
layout(matrix(1:2, ncol = 2))
plot(fit, add = F)
colvec <- c("red", "greem")
scl <- 1
plot(ord, type = "n", scaling = scl)
points(ord, display = "sites", col = colvec[status], pch = (1:2)[status])
colvec <- c("red", "green")
points(ord, display = "sites", col = colvec[status], pch = (1:2)[status])
plot(ord, type = "n", scaling = scl)
points(ord, display = "sites", col = colvec[status], pch = (1:2)[status])
points(ord, display = "species", pch = "+")
plot(fit, add = T, col = "black")
layout(1)
View(varechem)
View(varespec)
NMDS.log <- log1p(ps)
NMDS.log <- log1p(relabundance_table)
data(dune)
NMDS.log.dune <- log1p(dune)
set.seed(42)
sol <- metaMDS(NMDS.log)
scrs <- as.data.frame(scores(sol, display = "sites"))
View(scrs)
sol.dune <- metaMDS(NMDS.log.dune)
scrs.dune <- as.data.frame(scores(sol.dune, display = "sites"))
View(scrs.dune)
scrs <- cbind(scrs, Group = c("taxa001", "taxa002","taxa003", "taxa004","taxa005", "taxa006","taxa007", "taxa008","taxa009", "taxa010","taxa011", "taxa012","taxa013", "taxa014", "taxa015"))
set.seed(123)
vf <- envfit(sol, NMDS.log, perm = 999)
vf
spp.scrs <- as.data.frame(scores(vf, display = "vectors"))
spp.scrs <- cbind(spp.scrs, Species = rownames(spp.scrs))
p <- ggplot(scrs) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group)) +
coord_fixed() +
geom_segment(data = spp.scrs,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "grey") +
geom_text(data = spp.scrs, aes(x = NMDS1, y = NMDS2, label = Species), size = 3)
p
View(sol)
scrs.spe <- as.data.frame(scores(sol, display = "species"))
View(scrs.spe)
scrs.spe <- cbind(scrs.spe, Group = c("Sample01", "Sample02", "Sample03", "Sample04", "Sample05", "Sample06", "Sample07", "Sample08", "Sample09", "Sample10"))
View(spp.scrs)
p.spe <- ggplot(scrs.spe) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group)) +
coord_fixed() +
geom_segment(data = spp.scrs,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "grey") +
geom_text(data = spp.scrs, aes(x = NMDS1, y = NMDS2, label = Species), size = 3)
p.spe
View(spp.scrs)
View(vf)
View(sol)
View(scrs)
View(NMDS.log)
p
# jsut going to transpose original table
relabundance_table.t <- as.data.frame(t(relabundance_table))
NMDS.log.t <- log1p(relabundance_table.t)
sol.t <- metaMDS(NMDS.log.t)
scrs.t <- as.data.frame(scores(sol.t, display = "sites"))
View(scrs.t)
scrs.t <- cbind(scrs.t, Group = c("Sample01", "Sample02", "Sample03", "Sample04", "Sample05", "Sample06", "Sample07", "Sample08", "Sample09", "Sample10"))
vf.t <- envfit(sol.t, NMDS.log.t, perm = 999)
spp.scrs.t <- as.data.frame(scores(vf.t, display = "vectors"))
spp.scrs.t <- cbind(spp.scrs.t, Species = rownames(spp.scrs.t))
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "grey") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3)
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "grey") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3)
p.t
View(relabundance_table.t)
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "grey") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.5, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 5) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Group, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p
ordination_bray_nmds_plot
library(cowplot)
plot_grid(ordination_bray_nmds_plot, p.t)
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, size =5)) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
View(scrs.t)
View(metadata)
scrs.t <- cbind(scrs.t, metadata)
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), check_overlap = T, size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3, label.padding = 0.5) +
theme_bw()
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1*.9, y = 0, yend = NMDS2*.9),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1, y = NMDS2, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1*.9, y = 0, yend = NMDS2*.9),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1*1.1, y = NMDS2*1.1, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1*1.1, y = NMDS2*1.1, label = Species), size = 3) +
theme_bw()
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1*1.1, y = NMDS2*1.1, label = Species), size = 3) +
theme_bw() +
theme(text = element_text(size = 16),
axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black"),
plot.title = element_text(face = "bold"))
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1*1.1, y = NMDS2*1.1, label = Species), size = 3) +
theme_bw() +
theme(axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black"))
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1*1.1, y = NMDS2*1.1, label = Species), size = 3) +
theme_bw() #+
p.t
p.t <- ggplot(scrs.t) +
geom_point(mapping = aes(x = NMDS1, y = NMDS2, color = Random_category), size =5) +
coord_fixed() +
geom_segment(data = spp.scrs.t,
aes(x = 0, xend = NMDS1, y = 0, yend = NMDS2),
arrow = arrow(length = unit(0.25, "cm")), color = "black") +
geom_text(data = spp.scrs.t, aes(x = NMDS1*1.1, y = NMDS2*1.1, label = Species), size = 3) +
theme_bw() +
theme(axis.text.x = element_text(colour="black"),
axis.text.y = element_text(colour="black"))
p.t
ordination_bray_cca_plot
ordination_bray_cat_one_plot
ordination_bray_plot
View(relabundance_table.t)
View(relabundance_table)
2096/174156
0.012*100
8/176
4.5
2/8
176000/2253000
0.078*100
(2096/2253000)*100
(32293/204390)*100
(388/204390)*100
